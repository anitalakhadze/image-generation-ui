<mat-toolbar color="accent">

  <mat-icon>account_circle</mat-icon>

  <span style="font-weight: bold; margin-left: 10px; cursor: pointer">
    {{authService.getLoggedInUser().currentUser?.email}}
  </span>

  <span class="example-spacer"></span>

  <button mat-raised-button (click)="signOut()" color="primary">
    <span>Sign out</span>
    <mat-icon>logout</mat-icon>
    <mat-spinner *ngIf="loading" mode="indeterminate" style="margin:0 auto;" [diameter]="30"></mat-spinner>
  </button>

</mat-toolbar>

<!--<div *ngIf="serviceLoading" class="welcome-text" style="text-align: center">-->
<!--  <h1>Welcome {{authService.getLoggedInUser().currentUser?.email}}!</h1>-->
<!--  <h3>You will be redirected to FollowFox.ai</h3>-->

<!--&lt;!&ndash;  <mat-spinner class="primary-spinner center"></mat-spinner>&ndash;&gt;-->
<!--</div>-->

<div class="main-container">
  <div class="left-container">
    <div class="form-container">
      <form [formGroup]="imageGenerationForm">
        <mat-form-field appearance="fill">
          <mat-label>Choose a model</mat-label>
          <mat-select formControlName="model" [(value)]="selectedModel">
            <mat-option *ngFor="let model of models" [value]="model">
              {{model}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Prompt</mat-label>
          <textarea formControlName="prompt"
                    matInput
                    cdkTextareaAutosize
                    cdkAutosizeMinRows="1"
                    cdkAutosizeMaxRows="5">
          </textarea>
        </mat-form-field>

        <div>
          <div style="float: left; width: 45%">
            <mat-form-field appearance="fill">
              <mat-label>Image height</mat-label>
              <mat-slider min="256" max="1024" step="1" showTickMarks discrete>
                <input matInput matSliderThumb formControlName="height">
              </mat-slider>
            </mat-form-field>
          </div>
          <div style="float: right; width: 45%">
            <mat-form-field appearance="fill">
              <mat-label>Image width</mat-label>
              <mat-slider min="256" max="1024" step="1" showTickMarks discrete>
                <input matInput matSliderThumb formControlName="width">
              </mat-slider>
            </mat-form-field>
          </div>
        </div>

        <mat-form-field appearance="fill">
          <mat-label>Sampling steps</mat-label>
          <mat-slider min="0" max="100" step="1" showTickMarks discrete>
            <input matInput matSliderThumb formControlName="num_inference_steps">
          </mat-slider>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Guidance scale</mat-label>
          <mat-slider min="1" max="50" step="0.1" showTickMarks discrete>
            <input matInput matSliderThumb formControlName="num_inference_steps">
          </mat-slider>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Negative prompt</mat-label>
          <textarea formControlName="negative_prompt"
                    matInput
                    cdkTextareaAutosize
                    cdkAutosizeMinRows="1"
                    cdkAutosizeMaxRows="5">
          </textarea>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Seed</mat-label>
          <input matInput formControlName="generator" type="number" min="0" max="1000">
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Sampling method</mat-label>
          <mat-select formControlName="scheduler" [(value)]="selectedSamplingMethod">
            <mat-option *ngFor="let method of samplingMethods" [value]="method">
              {{method}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <button mat-raised-button class="run-btn" color="primary"
                [disabled]="apiLoading"
                (click)="generate()">
          <span *ngIf="!apiLoading">Run</span>
          <mat-spinner *ngIf="apiLoading" mode="indeterminate" style="margin:0 auto;" [diameter]="30"></mat-spinner>
        </button>
      </form>
    </div>
  </div>

  <div class="right-container">
    <div class="images-container" *ngIf="this.images">
      <mat-grid-list cols="2" rowHeight="2:2">
        <mat-grid-tile *ngFor="let image of this.images.images">
          <input type="image"
                 [height]="275"
                 [width]="300"
                 [src]="'data:image/jpg;base64,' + image.image_base64" alt="">
        </mat-grid-tile>
      </mat-grid-list>
    </div>
  </div>
</div>
